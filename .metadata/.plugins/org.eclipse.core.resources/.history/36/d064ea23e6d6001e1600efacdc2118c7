package com.phone.mobile;
import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;
import java.util.Optional;
import java.util.stream.Collectors;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;



@Service
public class MobileService {
	@Autowired
	MobileDao mobiledao;
	public String saveMobileData(Mobile m) {
		return mobiledao.saveMobileData(m);
	}

	public String saveAllMobileData(List<Mobile> m) {
		return mobiledao.saveAllMobileData(m);
	}

	public List<Mobile> findAllMobileData() {
		return mobiledao.findAllMobileData();
	}

	public Optional<Mobile> findMobileDataById(int a) {		
		return mobiledao.findMobileDataById(a);
	}

	public String deleteMobileDataById(int a) {
		
		return mobiledao.deleteMobileDataById(a);
	}

	public List<Integer> getDiscountPrice() {
		List<Mobile> allDetails=mobiledao.findAllMobileData();
		List<Integer> discountValues=allDetails.stream().map(x->(x.getPrice()-x.getPrice()*x.getDiscount()/100)).collect(Collectors.toList());
		return discountValues;
	}

	public List<String> getUniqueBrandName() {
		List<Mobile> allDetails=mobiledao.findAllMobileData();
		List<String> uniqueBrand=allDetails.stream().map(x->x.getBrandname()).distinct().collect(Collectors.toList());
		return uniqueBrand;
	}

	public Optional<Mobile> secondHighestPrice() {
		List<Mobile> allDetails=mobiledao.findAllMobileData();
		Optional<Mobile> secondHighest=allDetails.stream().sorted(Comparator.comparingInt(Mobile::getPrice).reversed()).skip(1).limit(1).findFirst();
		return secondHighest;
	}

	public List<String> takeBrandMiddleLetter() {
		List<Mobile> allDetails=mobiledao.findAllMobileData();
		
		
		List<String> brandNames=allDetails.stream().map(x->x.getBrandname()).collect(Collectors.toList());
		List<String> result1=brandNames.stream().filter(x->(x.length()%2)==0).map(x->(x.substring(x.length()/2-1, x.length()/2+1))).collect(Collectors.toList());
		List<String> result2=brandNames.stream().filter(x->(x.length()%2)!=0).map(x->(x.substring(x.length()/2-1, x.length()/2))).collect(Collectors.toList());
		List<String> result=new ArrayList<>();
		for (String a : result1) {
			result.add(a);
        }
		for (String a : result2) {
			result.add(a);
        }
		
//			brandNames.stream().filter(x->(x.getBrandName().length()%2)==0).map(x->(x.getBrandName().charAt(x.getBrandName().length()/2))).collect(Collectors.toList());		
		return result;
	}
	
	
}

